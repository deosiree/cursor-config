---
name: prod-risk-check
description: 检查生产环境异常是否与循环依赖/初始化顺序有关
version: 1.0.0
author: Cursor Skills
---

# 生产环境风险检查插件

当你怀疑某个功能在生产环境表现异常时，帮助你判断：这个问题是否可能与"模块循环依赖 / 初始化顺序差异"有关（不限入口文件、不限全局属性）。

## 功能特性

### 1. 上下文收集
- 识别怀疑功能涉及的组件/视图文件路径
- 分析直接依赖的模块（API、store模块、service、全局属性等）
- 圈定"相关模块子图"，避免全仓库乱扫

### 2. 循环依赖检查
- 检查相关模块的import图
- 识别互相import关系（A import B，B又import A）
- 分析初始化顺序问题

### 3. 风险分析
- 评估循环依赖对生产环境的影响
- 识别潜在的初始化顺序问题
- 提供修复建议

## 触发方式

### 推荐用法
- `@prod-risk 某某功能在生产环境异常，帮我看一下是否可能和循环依赖有关`
- `@prod-risk 这个权限按钮在生产不显示，分析一下是不是循环依赖/初始化顺序问题`

### 自动识别
- 检测到生产环境异常描述
- 检测到权限、显示等生产环境问题

## 分析步骤（只读）

### 1. 收集怀疑功能的上下文
- 识别该功能涉及的组件/视图文件路径
- 分析直接依赖的模块
- 目标：圈定"相关模块子图"

### 2. 检查相关模块的import图
- 用grep/代码搜索，列出import/被import关系
- 尤其关注是否互相import
- 分析初始化顺序差异

### 3. 风险评估
- 评估循环依赖对生产环境的影响
- 识别潜在的初始化顺序问题
- 提供修复建议

## 使用场景

### 场景1：生产环境功能异常
- 某个功能在开发环境正常，但在生产环境异常
- 怀疑是循环依赖或初始化顺序问题

### 场景2：权限/显示问题
- 权限按钮在生产环境不显示
- 组件在生产环境渲染异常

### 场景3：初始化顺序问题
- 全局属性在生产环境未正确初始化
- 模块依赖关系导致生产环境问题

## 注意事项

- 插件本身只做**分析和定位**，不直接修改代码
- 需要明确的修复指令才能进行代码修改
- 分析结果应记录到文档中

## 技能文件

- `SKILL.md` - 完整的技能实现文档